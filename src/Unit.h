#pragma once

////////////////////////////////////////////////////////////////////////////////
#include "Healthbar.h"
#include "Pixel.h"

////////////////////////////////////////////////////////////////////////////////
class Unit : public sf::Drawable, public HealthComponent<Unit, float> {
public:

    ////////////////////////////////////////////////////////////////////////////
    Unit(const sf::Texture& tex,  const sf::Texture& turretTex, sf::Vector2f spawnPos);

    ////////////////////////////////////////////////////////////////////////////
    void MouseMove(sf::Vector2f mousePos);

    ////////////////////////////////////////////////////////////////////////////
    void StepPhysics(float deltaTime);

    ////////////////////////////////////////////////////////////////////////////
    sf::Vector2f GetCenter() const;

    ////////////////////////////////////////////////////////////////////////////
    sf::FloatRect GetGlobalBounds() const;

    ////////////////////////////////////////////////////////////////////////////
    sf::Color GetPixelGlobal(sf::Vector2f position) const;

    ////////////////////////////////////////////////////////////////////////////
    sf::Vector2f GetPosition() const;

    ////////////////////////////////////////////////////////////////////////////
    void SetPosition(sf::Vector2f newPos);

    ////////////////////////////////////////////////////////////////////////////
    sf::Vector2f GetSize() const;

    ////////////////////////////////////////////////////////////////////////////
    sf::Vector2f GetMuzzlePos() const;

    ////////////////////////////////////////////////////////////////////////////
    sf::Vector2f GetRotationPoint() const;

    ////////////////////////////////////////////////////////////////////////////
    void SetVelocity(sf::Vector2f newVelocity);

private:

    ////////////////////////////////////////////////////////////////////////////
    void draw(sf::RenderTarget &target, sf::RenderStates states) const override;

    ////////////////////////////////////////////////////////////////////////////
    sf::Image pixels;

    ////////////////////////////////////////////////////////////////////////////
    sf::Sprite sprite;

    ////////////////////////////////////////////////////////////////////////////
    sf::Sprite turretSprite;

    ////////////////////////////////////////////////////////////////////////////
    sf::Vector2f turretOffset;

    ////////////////////////////////////////////////////////////////////////////
    sf::Vector2f spriteCenterOffset;

    ////////////////////////////////////////////////////////////////////////////
    sf::Vector2f velocity{0.F, 0.F};

    ///////////////////////////////////////////////////////////////////////////
    float inverseMass = 1.F/100.F;

    ////////////////////////////////////////////////////////////////////////////
    float scale = 0.5F;

};
