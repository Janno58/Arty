#pragma once

////////////////////////////////////////////////////////////////////////////////
#include "Background.h"
#include "Vector.h"
#include "Pixel.h"

////////////////////////////////////////////////////////////////////////////////
class Level : public sf::Drawable {
public:

    ////////////////////////////////////////////////////////////////////////////
    Level(const std::string& levelName);

    ////////////////////////////////////////////////////////////////////////////
    sf::Color GetBackgroundColor() const;

    ////////////////////////////////////////////////////////////////////////////
    sf::Vector2f GetSize() const;

    ////////////////////////////////////////////////////////////////////////////
    sf::Color GetPixel(sf::Vector2f pos) const;

    ////////////////////////////////////////////////////////////////////////////
    std::pair<std::vector<uint8_t>, Vec2u> GetPixels() const;

    ////////////////////////////////////////////////////////////////////////////
    Vec2f GetSpawn(std::vector<sf::Vector2f>::size_type index) const;

    ////////////////////////////////////////////////////////////////////////////
    void SetPixels(const std::vector<Pixel>& newPixels);

private:

    ////////////////////////////////////////////////////////////////////////////
    void draw(sf::RenderTarget &target, sf::RenderStates states) const override;

    ////////////////////////////////////////////////////////////////////////////
    float width;
    
    ////////////////////////////////////////////////////////////////////////////
    float height;

    ////////////////////////////////////////////////////////////////////////////
    sf::Texture texture;

    ////////////////////////////////////////////////////////////////////////////
    sf::VertexArray vertices;

    ////////////////////////////////////////////////////////////////////////////
    std::vector<sf::Uint8> pixels;

    ////////////////////////////////////////////////////////////////////////////
    Background background;

    ////////////////////////////////////////////////////////////////////////////
    std::vector<sf::Vector2f> spawns;
};

////////////////////////////////////////////////////////////////////////////////
std::vector<std::string> EnumerateLevels();

////////////////////////////////////////////////////////////////////////////////
int GetMaxPlayers(const std::string&);