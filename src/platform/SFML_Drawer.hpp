#pragma once

////////////////////////////////////////////////////////////////////////////////
#include "../Player.h"
#include "../Projectile.h"
#include "../TextureCache.h"
#include <SFML/Graphics.hpp>

////////////////////////////////////////////////////////////////////////////////
class DrawableTank : public sf::Drawable {
public:

    ////////////////////////////////////////////////////////////////////////////
    DrawableTank(const Player &player, TextureCache &cache);

    ////////////////////////////////////////////////////////////////////////////
    void Update(const Player &player);

private:

    ////////////////////////////////////////////////////////////////////////////
    void draw(sf::RenderTarget& target, sf::RenderStates states) const override;

    ////////////////////////////////////////////////////////////////////////////
    sf::Sprite base;
    sf::Sprite turret;

    ////////////////////////////////////////////////////////////////////////////
    sf::RectangleShape bottomBar;
    sf::RectangleShape topBar;

};

////////////////////////////////////////////////////////////////////////////////
class SFML_Drawer : public sf::Drawable {
public:
	
	////////////////////////////////////////////////////////////////////////////
	SFML_Drawer();

    ////////////////////////////////////////////////////////////////////////////
    void CreateTanks(std::vector<Player>& players);

    ////////////////////////////////////////////////////////////////////////////
    void UpdateTanks(std::vector<Player>& players);

    ////////////////////////////////////////////////////////////////////////////
    void CreateProjectile(const Projectile &shell);

    ////////////////////////////////////////////////////////////////////////////
    void UpdateProjectile(const Projectile& shell);

    ////////////////////////////////////////////////////////////////////////////
    std::pair<std::vector<uint8_t>, Vec2u> GetTexturePixels(const std::string& textureName);

private:

    ////////////////////////////////////////////////////////////////////////////
    void draw(sf::RenderTarget& target, sf::RenderStates states) const override;

	////////////////////////////////////////////////////////////////////////////
	TextureCache textureCache;

    ////////////////////////////////////////////////////////////////////////////
    std::vector<DrawableTank> tanks;

    ////////////////////////////////////////////////////////////////////////////
    sf::Sprite projectile;

    ////////////////////////////////////////////////////////////////////////////
    bool drawProjectile = false;

};
